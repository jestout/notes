
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<link href="https://test.example/gaussian-processes/regression/" rel="canonical"/>
<link href="../.." rel="prev"/>
<link href="../../assets/images/favicon.png" rel="icon"/>
<meta content="mkdocs-1.6.1, mkdocs-material-9.5.46" name="generator"/>
<title>Regression - John's Brain</title>
<link href="../../assets/stylesheets/main.6f8fc17f.min.css" rel="stylesheet"/>
<link href="../../assets/stylesheets/palette.06af60db.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Inter:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Inter";--md-code-font:"Roboto Mono"}</style>
<link href="../../stylesheets/extra.css" rel="stylesheet"/>
<script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
<script src="https://cdn.plot.ly/plotly-latest.min.js"></script></head>
<body data-md-color-accent="deep-purple" data-md-color-primary="blue-grey" data-md-color-scheme="slate" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#regression">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="John's Brain" class="md-header__button md-logo" data-md-component="logo" href="../.." title="John's Brain">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            John's Brain
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Regression
            
          </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-label="Dark Mode" class="md-option" data-md-color-accent="deep-purple" data-md-color-media="" data-md-color-primary="blue-grey" data-md-color-scheme="slate" id="__palette_0" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_1" hidden="" title="Dark Mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"></path></svg>
</label>
<input aria-label="Light mode" class="md-option" data-md-color-accent="deep-orange" data-md-color-media="" data-md-color-primary="blue" data-md-color-scheme="default" id="__palette_1" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_0" hidden="" title="Light mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"></path></svg>
</label>
</form>
<script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
</nav>
</header>
<div class="md-container" data-md-component="container">
<nav aria-label="Tabs" class="md-tabs" data-md-component="tabs">
<div class="md-grid">
<ul class="md-tabs__list">
<li class="md-tabs__item">
<a class="md-tabs__link" href="../..">
        
  
    
  
  Welcome to MkDocs

      </a>
</li>
<li class="md-tabs__item md-tabs__item--active">
<a class="md-tabs__link" href="./">
          
  
  Gaussian processes

        </a>
</li>
</ul>
</div>
</nav>
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--lifted" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="John's Brain" class="md-nav__button md-logo" data-md-component="logo" href="../.." title="John's Brain">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg>
</a>
    John's Brain
  </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../..">
<span class="md-ellipsis">
    Welcome to MkDocs
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
<span class="md-ellipsis">
    Gaussian processes
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_2_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
            Gaussian processes
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
<span class="md-ellipsis">
    Regression
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
<span class="md-ellipsis">
    Regression
  </span>
</a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#the-weight-space-view">
<span class="md-ellipsis">
      The Weight Space View
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#projections-of-inputs-into-feature-space">
<span class="md-ellipsis">
      Projections of Inputs into Feature Space
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#the-weight-space-view">
<span class="md-ellipsis">
      The Weight Space View
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#projections-of-inputs-into-feature-space">
<span class="md-ellipsis">
      Projections of Inputs into Feature Space
    </span>
</a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h1 id="regression">Regression</h1>
<p>In general, the main goal of regression is to go from some training data <span class="arithmatex">\(\mathcal{D}\)</span> to a function that makes predictions for all possible input values. To do this, we must make assumptions about the underlying function that generated that data. We could do so by, say, assuming a particular functional form like that it is a linear map, and then finding the linear map which best fits the data. Or, we could encode our beliefs about the function into a prior probability distribution, i.e. that these are smooth or periodic functions. This is a much more general class of functions to choose from and thus a much weaker assumption, so ideally this is a more attractive way of doing inference. However, given that we are supposed to then select a particular function from this uncountably infinite space of functions, it seems completely infeasible to actually do this. This is where Gaussian processes come to the rescue, allowing us to describe our beliefs about a space of functions in a particularly computationally efficient way. </p>
<p>There are several ways to interpret a Gaussian process regression model. One can think of a Gaussian process as defining a distribution over functions, and inference taking place directly in the space of functions. This is the so-called <em>function space view</em>. One can also think about it in an equivalent <em>weight space view</em>, which we'll now describe. We will then connect this perspective to the function space view.</p>
<h2 id="the-weight-space-view">The Weight Space View</h2>
<p>It will be simplest to start with a review of how standard linear regression fits into the Bayesian framework. </p>
<div class="admonition danger">
<p class="admonition-title">Conventions</p>
<p>Rasmussen and Williams define the training set <span class="arithmatex">\(\mathcal{D}\)</span> of <span class="arithmatex">\(n\)</span> observations, <span class="arithmatex">\(\mathcal{D}((\mb{x}_i, y_i)\,|\, i = 1, \ldots, n)\)</span>, where the input vectors <span class="arithmatex">\(\mb{x}\)</span> have dimension <span class="arithmatex">\(d\)</span> (or <span class="arithmatex">\(D\)</span>), and they aggregate the inputs (or covariates) into a <em>design matrix</em> <span class="arithmatex">\(X\)</span> with dimension <span class="arithmatex">\(d \times n\)</span>. This is opposite to how <code>torch</code> tends to handle these things, where it assumes that rows correspond to samples and columns correspond to index. As annoying as it is, to translate into <code>torch</code> code it will be convenient to think of <span class="arithmatex">\(X\)</span> as a <span class="arithmatex">\(n\times d\)</span> matrix.</p>
<p>I find all of this matrix notation generally confusing because it is too easy to mix up the fact that there are two completely ontologically separate spaces. Maybe that's just the quantum mechanic in me, where I like to think of everything as happening in the same Hilbert space. However, it also obscures the fact that parameter space and sample space can (and do) have completely different geometries. So, instead of following directly along with Rasmussen and Williams, it will be useful to extend their notation in a way that more directly exposes this geometry. After all, we should work with a notation that naturally meshes with the structure of the objects we are working with.</p>
<p>I will use <span class="arithmatex">\(w^a\)</span> to denote coordinates on parameter space, with <span class="arithmatex">\(a,b, \ldots = 1, \cdots, d\)</span>. It's useful to think of this as an upper index because an infinitesimal <span class="arithmatex">\(\ud w^a\)</span> should definitely exist in the tangent space. I'll use <span class="arithmatex">\(i, j, \ldots = 1, \ldots, n\)</span> to denote indices in <em>sample space</em>, i.e. to label samples. We will assume that the samples are i.i.d. and that the noise is homoskedastic, so that the local geometry of sample space is just plain Euclidean. Topologically, sample space is <span class="arithmatex">\(\mathbb{R}^n/\lab{S}_n\)</span>, where <span class="arithmatex">\(\lab{S}_n\)</span> is the symmetric permutation group, since we don't care what order the samples come in. This actually doesn't seem to be studied that much, except for this recent paper <a href="https://arxiv.org/abs/2010.08039">[2010.08039]</a>, and it's not necessarily clear to me whether one gains a lot by considering that orbifold. To that end, I'll not worry too much about that metric on sample space and instead freely raise and lower sample indices. Of course, repeated indices indicate an implicit summation.</p>
<p>Honestly, this makes it a lot easier to see what's going on, especially when there are multiple unrelated spaces floating around.</p>
</div>
<p>Let us consider the linear map <span class="arithmatex">\(f(x) = x_a w^a\)</span>, which we will assume is related to the noisily observed value <span class="arithmatex">\(y\)</span> by <span class="arithmatex">\(y = f(x) + \varepsilon\)</span> with <span class="arithmatex">\(\varepsilon \sim \mathcal{N}(0, \sigma_n^2)\)</span> a normally distributed variable with standard deviation <span class="arithmatex">\(\sigma_n\)</span>. We will stick to the case where <span class="arithmatex">\(x, y  \in \mathbb{R}\)</span> and write <span class="arithmatex">\(x_a = (1, x)\)</span> so that a general linear function <span class="arithmatex">\(f(x) = w_0 + w_1 x\)</span> can be written as an inner product. For <span class="arithmatex">\(n\)</span> samples, we can just append an index on everything and write <span class="arithmatex">\(y^i = X^i_a w^a + \varepsilon^i\)</span> (a different realization of <span class="arithmatex">\(\varepsilon\)</span> for each sample) and collect all of the noisy measurements into <span class="arithmatex">\(y^i = \mb{y}\)</span>.</p>
<p>We will assume that the <strong>true model</strong> (without noise, or said differently the mean of the true data generating process) has <span class="arithmatex">\(w^a = (1, 1)\)</span>. This is the true model if we assume that <span class="arithmatex">\(\sigma_n\)</span> represents some additional, obstructing noise that is a side effect of the measurement process; or we can simply think of <span class="arithmatex">\(f(\mb{x})\)</span> as a model for the mean of the distribution. We can construct the generative model for this data by assuming that each point is pulled from a normal distribution (it is) with some <span class="arithmatex">\(\sigma_n\)</span> standard deviation and mean centered around <span class="arithmatex">\(f(x^i) = x^i_a w^a\)</span> for some parameters <span class="arithmatex">\(w^a\)</span>. As an example, we can plot data generated by this random process, compared to model <span class="arithmatex">\(f(\mb{x})\)</span>:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio"><input id="__tabbed_1_2" name="__tabbed_1" type="radio"><div class="tabbed-labels"><label for="__tabbed_1_1">Plot</label><label for="__tabbed_1_2">Code</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="mkdocs-plotly" data-jsonpath="../code/regression/line_data.json"></div>
</div>
<div class="tabbed-block">
<div class="language-py highlight"><span class="filename">Generative Model</span><pre><span></span><code><span id="__span-0-1"><a href="#__codelineno-0-1" id="__codelineno-0-1" name="__codelineno-0-1"></a>    <span class="n">sigt</span> <span class="o">=</span> <span class="mf">0.1</span>
</span><span id="__span-0-2"><a href="#__codelineno-0-2" id="__codelineno-0-2" name="__codelineno-0-2"></a>    <span class="n">wt</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
</span><span id="__span-0-3"><a href="#__codelineno-0-3" id="__codelineno-0-3" name="__codelineno-0-3"></a>
</span><span id="__span-0-4"><a href="#__codelineno-0-4" id="__codelineno-0-4" name="__codelineno-0-4"></a>    <span class="k">def</span> <span class="nf">gen_model</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">sig</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
</span><span id="__span-0-5"><a href="#__codelineno-0-5" id="__codelineno-0-5" name="__codelineno-0-5"></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">((</span><span class="n">torch</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span><span class="p">),</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="__span-0-6"><a href="#__codelineno-0-6" id="__codelineno-0-6" name="__codelineno-0-6"></a>        <span class="n">f</span> <span class="o">=</span> <span class="n">x</span> <span class="o">@</span> <span class="n">w</span>
</span><span id="__span-0-7"><a href="#__codelineno-0-7" id="__codelineno-0-7" name="__codelineno-0-7"></a>        <span class="n">noise</span> <span class="o">=</span> <span class="n">sig</span><span class="o">*</span><span class="n">torch</span><span class="o">.</span><span class="n">randn_like</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span><span id="__span-0-8"><a href="#__codelineno-0-8" id="__codelineno-0-8" name="__codelineno-0-8"></a>        <span class="k">return</span> <span class="n">f</span> <span class="o">+</span> <span class="n">noise</span>
</span><span id="__span-0-9"><a href="#__codelineno-0-9" id="__codelineno-0-9" name="__codelineno-0-9"></a>
</span><span id="__span-0-10"><a href="#__codelineno-0-10" id="__codelineno-0-10" name="__codelineno-0-10"></a>    <span class="n">test_x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="__span-0-11"><a href="#__codelineno-0-11" id="__codelineno-0-11" name="__codelineno-0-11"></a>
</span><span id="__span-0-12"><a href="#__codelineno-0-12" id="__codelineno-0-12" name="__codelineno-0-12"></a>    <span class="n">test_y</span> <span class="o">=</span> <span class="n">gen_model</span><span class="p">(</span><span class="n">wt</span><span class="p">,</span> <span class="n">sigt</span><span class="p">,</span> <span class="n">test_x</span><span class="p">)</span>
</span><span id="__span-0-13"><a href="#__codelineno-0-13" id="__codelineno-0-13" name="__codelineno-0-13"></a>    <span class="n">true_y</span> <span class="o">=</span> <span class="n">gen_model</span><span class="p">(</span><span class="n">wt</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">test_x</span><span class="p">)</span>
</span><span id="__span-0-14"><a href="#__codelineno-0-14" id="__codelineno-0-14" name="__codelineno-0-14"></a>
</span><span id="__span-0-15"><a href="#__codelineno-0-15" id="__codelineno-0-15" name="__codelineno-0-15"></a>    <span class="n">line_data</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>
</span><span id="__span-0-16"><a href="#__codelineno-0-16" id="__codelineno-0-16" name="__codelineno-0-16"></a>    <span class="n">line_data</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">test_x</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">y</span><span class="o">=</span><span class="n">test_y</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'markers'</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">'Gen. Model'</span><span class="p">))</span>
</span><span id="__span-0-17"><a href="#__codelineno-0-17" id="__codelineno-0-17" name="__codelineno-0-17"></a>    <span class="n">line_data</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">test_x</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">y</span><span class="o">=</span><span class="n">true_y</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'lines'</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">'True Model'</span><span class="p">))</span>
</span><span id="__span-0-18"><a href="#__codelineno-0-18" id="__codelineno-0-18" name="__codelineno-0-18"></a>    <span class="n">line_data</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">xaxis</span><span class="o">=</span><span class="p">{</span><span class="s1">'title'</span><span class="p">:</span> <span class="s1">'x'</span><span class="p">},</span> <span class="n">yaxis</span><span class="o">=</span><span class="p">{</span><span class="s1">'title'</span><span class="p">:</span> <span class="s1">'y'</span><span class="p">})</span>
</span><span id="__span-0-19"><a href="#__codelineno-0-19" id="__codelineno-0-19" name="__codelineno-0-19"></a>    <span class="n">line_data</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span><span id="__span-0-20"><a href="#__codelineno-0-20" id="__codelineno-0-20" name="__codelineno-0-20"></a>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'line_data.json'</span><span class="p">,</span> <span class="s1">'w+'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="__span-0-21"><a href="#__codelineno-0-21" id="__codelineno-0-21" name="__codelineno-0-21"></a>        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line_data</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="s1">'line_data.json'</span><span class="p">))</span>
</span></code></pre></div>
</div>
</div>
</input></input></div>
<p>The <strong>likelihood</strong> of the data is then </p>
<div class="arithmatex">\[
\begin{aligned} p(\mb{y} | X, \mb{w}) &amp;= \prod_{i = 1}^{n} p(y_i | \mb{x}_i , \mb{w}) = \prod_{i = 1}^{n} \frac{1}{\sqrt{2 \pi \sigma_n^2}} \exp\left(-\frac{(y_i - \mb{x}_i \cdot \mb{w})^2}{2 \sigma_n^2}\right) \\
&amp;= \frac{1}{(2 \pi \sigma_n^2)^{n/2}} \exp\left(-\frac{1}{2 \sigma_n^2}|\mb{y} - X \mb{w}|^2\right) 
\end{aligned}
\]</div>
<p>Here, we have introduced the design matrix <span class="arithmatex">\(X = X_i^a\)</span>, so <span class="arithmatex">\(X \mb{w} = X_i^a w_a\)</span>. Generally in the Bayesian formalism we should also specify a prior on the weights <span class="arithmatex">\(\mb{w}\)</span>. We will assume that <span class="arithmatex">\(\mb{w} \sim \mathcal{N}(0, \Sigma_p) \propto \exp(-\frac{1}{2} \mb{w}^\top \Sigma_p^{-1} \mb{w})\)</span>. It seems like it will actually be convenient to use this prior covariance as a metric; after all, it is the Fisher information metric for the parameters <span class="arithmatex">\(w_a\)</span> </p>
<p>We can then construct a posterior distribution for the weights via the product rule, namely</p>
<div class="arithmatex">\[ p(\mb{w} | \mb{y}, X) = \frac{p(\mb{y} | X, \mb{w}) p(\mb{w})}{p(\mb{y} | X)}\,. \]</div>
<p>The bottom doesn't depend on <span class="arithmatex">\(\mb{w}\)</span>, so we can just focus on the top and then normalize. The numerator has the form</p>
<div class="arithmatex">\[ p(\mb{y} | X, \mb{w}) p(\mb{w}) \propto \exp\left(-\frac{1}{2 \sigma_n^2}|\mb{y} - X \mb{w}|^2 - \frac{1}{2} \mb{w}^\top \Sigma_p^{-1} \mb{w}\right)\]</div>
<p>The easiest way to group terms is to just take a derivative of the (negative) argument with respect to <span class="arithmatex">\(\mb{w}\)</span>, yielding</p>
<div class="arithmatex">\[ \sigma_n^{-2} X^\top (X \mb{w} - \mb{y}) + \Sigma_p^{-1} \mb{w} = 0\]</div>
<p>which has the straightforward solution</p>
<div class="arithmatex">\[ \bar{\mb{w}} = \sigma_n^{-2} \left(\Sigma_p^{-1} + \sigma_n^{-2} X^\top X\right)^{-1} X^\top \mb{y},\]</div>
<p>while the concavity is given by</p>
<div class="arithmatex">\[ A \equiv \frac{1}{\sigma_n^2} X^\top X + \Sigma_p^{-1}\,.\]</div>
<p>This means that the posterior distribution on the weights is</p>
<div class="arithmatex">\[ p(\mb{w} | \mb{y}, X) = \mathcal{N}(\bar{\mb{w}}, A^{-1})\,.\]</div>
<p>We can very easily plot and sample this posterior, for <span class="arithmatex">\(\sigma = 0.1\)</span> and <span class="arithmatex">\(\sigma_n = 0.1\)</span>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio"><input id="__tabbed_2_2" name="__tabbed_2" type="radio"><div class="tabbed-labels"><label for="__tabbed_2_1">Plot</label><label for="__tabbed_2_2">Code</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="mkdocs-plotly" data-jsonpath="../code/regression/posterior_sampling.json"></div>
</div>
<div class="tabbed-block">
<div class="language-py highlight"><span class="filename">Posterior Sampling</span><pre><span></span><code><span id="__span-1-1"><a href="#__codelineno-1-1" id="__codelineno-1-1" name="__codelineno-1-1"></a>    <span class="n">test_X</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">((</span><span class="n">torch</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">test_x</span><span class="p">),</span> <span class="n">test_x</span><span class="p">),</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="__span-1-2"><a href="#__codelineno-1-2" id="__codelineno-1-2" name="__codelineno-1-2"></a>
</span><span id="__span-1-3"><a href="#__codelineno-1-3" id="__codelineno-1-3" name="__codelineno-1-3"></a>    <span class="c1"># Will assume simple covariance matrix, could think about constructing </span>
</span><span id="__span-1-4"><a href="#__codelineno-1-4" id="__codelineno-1-4" name="__codelineno-1-4"></a>    <span class="c1"># an extremely weak prior</span>
</span><span id="__span-1-5"><a href="#__codelineno-1-5" id="__codelineno-1-5" name="__codelineno-1-5"></a>    <span class="n">Sigma_p</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span><span id="__span-1-6"><a href="#__codelineno-1-6" id="__codelineno-1-6" name="__codelineno-1-6"></a>    <span class="n">sigma_n</span> <span class="o">=</span> <span class="mf">0.2</span>
</span><span id="__span-1-7"><a href="#__codelineno-1-7" id="__codelineno-1-7" name="__codelineno-1-7"></a>    <span class="n">A</span> <span class="o">=</span> <span class="n">sigma_n</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">test_X</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">test_X</span> <span class="o">+</span> <span class="n">torch</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">Sigma_p</span><span class="p">)</span>
</span><span id="__span-1-8"><a href="#__codelineno-1-8" id="__codelineno-1-8" name="__codelineno-1-8"></a>    <span class="n">Ainv</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</span><span id="__span-1-9"><a href="#__codelineno-1-9" id="__codelineno-1-9" name="__codelineno-1-9"></a>    <span class="n">wb</span> <span class="o">=</span> <span class="n">sigma_n</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">Ainv</span> <span class="o">@</span> <span class="n">test_X</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">test_y</span>
</span><span id="__span-1-10"><a href="#__codelineno-1-10" id="__codelineno-1-10" name="__codelineno-1-10"></a>
</span><span id="__span-1-11"><a href="#__codelineno-1-11" id="__codelineno-1-11" name="__codelineno-1-11"></a>    <span class="n">posterior</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">distributions</span><span class="o">.</span><span class="n">MultivariateNormal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">wb</span><span class="p">,</span> <span class="n">precision_matrix</span><span class="o">=</span><span class="n">A</span><span class="p">)</span>
</span><span id="__span-1-12"><a href="#__codelineno-1-12" id="__codelineno-1-12" name="__codelineno-1-12"></a>
</span><span id="__span-1-13"><a href="#__codelineno-1-13" id="__codelineno-1-13" name="__codelineno-1-13"></a>    <span class="n">w_range</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
</span><span id="__span-1-14"><a href="#__codelineno-1-14" id="__codelineno-1-14" name="__codelineno-1-14"></a>    <span class="n">W0</span><span class="p">,</span> <span class="n">W1</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">w_range</span><span class="p">,</span> <span class="n">w_range</span><span class="p">,</span> <span class="n">indexing</span><span class="o">=</span><span class="s1">'xy'</span><span class="p">)</span>
</span><span id="__span-1-15"><a href="#__codelineno-1-15" id="__codelineno-1-15" name="__codelineno-1-15"></a>    <span class="n">F</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">posterior</span><span class="o">.</span><span class="n">log_prob</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">dstack</span><span class="p">((</span><span class="n">W0</span><span class="p">,</span> <span class="n">W1</span><span class="p">))</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">view_as</span><span class="p">(</span><span class="n">W0</span><span class="p">))</span>
</span><span id="__span-1-16"><a href="#__codelineno-1-16" id="__codelineno-1-16" name="__codelineno-1-16"></a>
</span><span id="__span-1-17"><a href="#__codelineno-1-17" id="__codelineno-1-17" name="__codelineno-1-17"></a>    <span class="c1"># %%</span>
</span><span id="__span-1-18"><a href="#__codelineno-1-18" id="__codelineno-1-18" name="__codelineno-1-18"></a>
</span><span id="__span-1-19"><a href="#__codelineno-1-19" id="__codelineno-1-19" name="__codelineno-1-19"></a>    <span class="n">fig</span> <span class="o">=</span> <span class="n">make_subplots</span><span class="p">(</span><span class="n">rows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">horizontal_spacing</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
</span><span id="__span-1-20"><a href="#__codelineno-1-20" id="__codelineno-1-20" name="__codelineno-1-20"></a>
</span><span id="__span-1-21"><a href="#__codelineno-1-21" id="__codelineno-1-21" name="__codelineno-1-21"></a>    <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Contour</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">w_range</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">w_range</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="n">F</span><span class="p">),</span> <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="__span-1-22"><a href="#__codelineno-1-22" id="__codelineno-1-22" name="__codelineno-1-22"></a>    <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">test_x</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">y</span><span class="o">=</span><span class="n">test_y</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'markers'</span><span class="p">),</span> <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="__span-1-23"><a href="#__codelineno-1-23" id="__codelineno-1-23" name="__codelineno-1-23"></a>    <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
</span><span id="__span-1-24"><a href="#__codelineno-1-24" id="__codelineno-1-24" name="__codelineno-1-24"></a>        <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
</span><span id="__span-1-25"><a href="#__codelineno-1-25" id="__codelineno-1-25" name="__codelineno-1-25"></a>            <span class="n">x</span><span class="o">=</span><span class="n">test_x</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span>
</span><span id="__span-1-26"><a href="#__codelineno-1-26" id="__codelineno-1-26" name="__codelineno-1-26"></a>            <span class="n">y</span><span class="o">=</span><span class="n">true_y</span><span class="p">,</span>
</span><span id="__span-1-27"><a href="#__codelineno-1-27" id="__codelineno-1-27" name="__codelineno-1-27"></a>            <span class="n">mode</span><span class="o">=</span><span class="s1">'lines'</span><span class="p">,</span>
</span><span id="__span-1-28"><a href="#__codelineno-1-28" id="__codelineno-1-28" name="__codelineno-1-28"></a>            <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">px</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">qualitative</span><span class="o">.</span><span class="n">D3</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
</span><span id="__span-1-29"><a href="#__codelineno-1-29" id="__codelineno-1-29" name="__codelineno-1-29"></a>        <span class="p">),</span>
</span><span id="__span-1-30"><a href="#__codelineno-1-30" id="__codelineno-1-30" name="__codelineno-1-30"></a>        <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="__span-1-31"><a href="#__codelineno-1-31" id="__codelineno-1-31" name="__codelineno-1-31"></a>        <span class="n">col</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="__span-1-32"><a href="#__codelineno-1-32" id="__codelineno-1-32" name="__codelineno-1-32"></a>    <span class="p">)</span>
</span><span id="__span-1-33"><a href="#__codelineno-1-33" id="__codelineno-1-33" name="__codelineno-1-33"></a>
</span><span id="__span-1-34"><a href="#__codelineno-1-34" id="__codelineno-1-34" name="__codelineno-1-34"></a>    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">):</span>
</span><span id="__span-1-35"><a href="#__codelineno-1-35" id="__codelineno-1-35" name="__codelineno-1-35"></a>        <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
</span><span id="__span-1-36"><a href="#__codelineno-1-36" id="__codelineno-1-36" name="__codelineno-1-36"></a>            <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
</span><span id="__span-1-37"><a href="#__codelineno-1-37" id="__codelineno-1-37" name="__codelineno-1-37"></a>                <span class="n">x</span><span class="o">=</span><span class="n">test_x</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span>
</span><span id="__span-1-38"><a href="#__codelineno-1-38" id="__codelineno-1-38" name="__codelineno-1-38"></a>                <span class="n">y</span><span class="o">=</span><span class="n">gen_model</span><span class="p">(</span><span class="n">posterior</span><span class="o">.</span><span class="n">sample</span><span class="p">(),</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">test_x</span><span class="p">),</span>
</span><span id="__span-1-39"><a href="#__codelineno-1-39" id="__codelineno-1-39" name="__codelineno-1-39"></a>                <span class="n">mode</span><span class="o">=</span><span class="s1">'lines'</span><span class="p">,</span>
</span><span id="__span-1-40"><a href="#__codelineno-1-40" id="__codelineno-1-40" name="__codelineno-1-40"></a>                <span class="n">opacity</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
</span><span id="__span-1-41"><a href="#__codelineno-1-41" id="__codelineno-1-41" name="__codelineno-1-41"></a>                <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">px</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">qualitative</span><span class="o">.</span><span class="n">D3</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
</span><span id="__span-1-42"><a href="#__codelineno-1-42" id="__codelineno-1-42" name="__codelineno-1-42"></a>            <span class="p">),</span>
</span><span id="__span-1-43"><a href="#__codelineno-1-43" id="__codelineno-1-43" name="__codelineno-1-43"></a>            <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="__span-1-44"><a href="#__codelineno-1-44" id="__codelineno-1-44" name="__codelineno-1-44"></a>            <span class="n">col</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="__span-1-45"><a href="#__codelineno-1-45" id="__codelineno-1-45" name="__codelineno-1-45"></a>        <span class="p">)</span>
</span><span id="__span-1-46"><a href="#__codelineno-1-46" id="__codelineno-1-46" name="__codelineno-1-46"></a>
</span><span id="__span-1-47"><a href="#__codelineno-1-47" id="__codelineno-1-47" name="__codelineno-1-47"></a>    <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">margin</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">l</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">20</span><span class="p">))</span>
</span><span id="__span-1-48"><a href="#__codelineno-1-48" id="__codelineno-1-48" name="__codelineno-1-48"></a>    <span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></code></pre></div>
</div>
</div>
</input></input></div>
<p>If we instead assume that the data is noiseless, then this collapses the posterior to a much smaller region. Below, we take <span class="arithmatex">\(\sigma_n = 0.01\)</span>; note the much smaller range of the contour plot, and much tighter grouping of the randomly sampled lines.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="3:2"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio"><input id="__tabbed_3_2" name="__tabbed_3" type="radio"><div class="tabbed-labels"><label for="__tabbed_3_1">Plot</label><label for="__tabbed_3_2">Code</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="mkdocs-plotly" data-jsonpath="../code/regression/posterior_sampling2.json"></div>
</div>
<div class="tabbed-block">
<div class="language-py highlight"><span class="filename">Posterior Sampling</span><pre><span></span><code><span id="__span-2-1"><a href="#__codelineno-2-1" id="__codelineno-2-1" name="__codelineno-2-1"></a>    <span class="n">sigt</span> <span class="o">=</span> <span class="mf">0.1</span>
</span><span id="__span-2-2"><a href="#__codelineno-2-2" id="__codelineno-2-2" name="__codelineno-2-2"></a>    <span class="n">wt</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
</span><span id="__span-2-3"><a href="#__codelineno-2-3" id="__codelineno-2-3" name="__codelineno-2-3"></a>    <span class="n">test_X</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">((</span><span class="n">torch</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">test_x</span><span class="p">),</span> <span class="n">test_x</span><span class="p">),</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="__span-2-4"><a href="#__codelineno-2-4" id="__codelineno-2-4" name="__codelineno-2-4"></a>
</span><span id="__span-2-5"><a href="#__codelineno-2-5" id="__codelineno-2-5" name="__codelineno-2-5"></a>    <span class="n">Sigma_p</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span><span id="__span-2-6"><a href="#__codelineno-2-6" id="__codelineno-2-6" name="__codelineno-2-6"></a>    <span class="n">sigma_n</span> <span class="o">=</span> <span class="mf">0.01</span>
</span><span id="__span-2-7"><a href="#__codelineno-2-7" id="__codelineno-2-7" name="__codelineno-2-7"></a>    <span class="n">A</span> <span class="o">=</span> <span class="n">sigma_n</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">test_X</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">test_X</span> <span class="o">+</span> <span class="n">torch</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">Sigma_p</span><span class="p">)</span>
</span><span id="__span-2-8"><a href="#__codelineno-2-8" id="__codelineno-2-8" name="__codelineno-2-8"></a>    <span class="n">Ainv</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</span><span id="__span-2-9"><a href="#__codelineno-2-9" id="__codelineno-2-9" name="__codelineno-2-9"></a>    <span class="n">wb</span> <span class="o">=</span> <span class="n">sigma_n</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">Ainv</span> <span class="o">@</span> <span class="n">test_X</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">test_y</span>
</span><span id="__span-2-10"><a href="#__codelineno-2-10" id="__codelineno-2-10" name="__codelineno-2-10"></a>
</span><span id="__span-2-11"><a href="#__codelineno-2-11" id="__codelineno-2-11" name="__codelineno-2-11"></a>    <span class="n">posterior</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">distributions</span><span class="o">.</span><span class="n">MultivariateNormal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="n">wb</span><span class="p">,</span> <span class="n">precision_matrix</span><span class="o">=</span><span class="n">A</span><span class="p">)</span>
</span><span id="__span-2-12"><a href="#__codelineno-2-12" id="__codelineno-2-12" name="__codelineno-2-12"></a>
</span><span id="__span-2-13"><a href="#__codelineno-2-13" id="__codelineno-2-13" name="__codelineno-2-13"></a>    <span class="n">w0_range</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.95</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
</span><span id="__span-2-14"><a href="#__codelineno-2-14" id="__codelineno-2-14" name="__codelineno-2-14"></a>    <span class="n">w1_range</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
</span><span id="__span-2-15"><a href="#__codelineno-2-15" id="__codelineno-2-15" name="__codelineno-2-15"></a>    <span class="n">W0</span><span class="p">,</span> <span class="n">W1</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">w0_range</span><span class="p">,</span> <span class="n">w1_range</span><span class="p">,</span> <span class="n">indexing</span><span class="o">=</span><span class="s1">'xy'</span><span class="p">)</span>
</span><span id="__span-2-16"><a href="#__codelineno-2-16" id="__codelineno-2-16" name="__codelineno-2-16"></a>
</span><span id="__span-2-17"><a href="#__codelineno-2-17" id="__codelineno-2-17" name="__codelineno-2-17"></a>    <span class="n">F</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">posterior</span><span class="o">.</span><span class="n">log_prob</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">dstack</span><span class="p">((</span><span class="n">W0</span><span class="p">,</span> <span class="n">W1</span><span class="p">))</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">view_as</span><span class="p">(</span><span class="n">W0</span><span class="p">))</span>
</span><span id="__span-2-18"><a href="#__codelineno-2-18" id="__codelineno-2-18" name="__codelineno-2-18"></a>
</span><span id="__span-2-19"><a href="#__codelineno-2-19" id="__codelineno-2-19" name="__codelineno-2-19"></a>    <span class="n">fig</span> <span class="o">=</span> <span class="n">make_subplots</span><span class="p">(</span><span class="n">rows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">horizontal_spacing</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
</span><span id="__span-2-20"><a href="#__codelineno-2-20" id="__codelineno-2-20" name="__codelineno-2-20"></a>
</span><span id="__span-2-21"><a href="#__codelineno-2-21" id="__codelineno-2-21" name="__codelineno-2-21"></a>    <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Contour</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">w0_range</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">w1_range</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="n">F</span><span class="p">),</span> <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="__span-2-22"><a href="#__codelineno-2-22" id="__codelineno-2-22" name="__codelineno-2-22"></a>    <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">test_x</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">y</span><span class="o">=</span><span class="n">test_y</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">'markers'</span><span class="p">),</span> <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="__span-2-23"><a href="#__codelineno-2-23" id="__codelineno-2-23" name="__codelineno-2-23"></a>    <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
</span><span id="__span-2-24"><a href="#__codelineno-2-24" id="__codelineno-2-24" name="__codelineno-2-24"></a>        <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
</span><span id="__span-2-25"><a href="#__codelineno-2-25" id="__codelineno-2-25" name="__codelineno-2-25"></a>            <span class="n">x</span><span class="o">=</span><span class="n">test_x</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span>
</span><span id="__span-2-26"><a href="#__codelineno-2-26" id="__codelineno-2-26" name="__codelineno-2-26"></a>            <span class="n">y</span><span class="o">=</span><span class="n">true_y</span><span class="p">,</span>
</span><span id="__span-2-27"><a href="#__codelineno-2-27" id="__codelineno-2-27" name="__codelineno-2-27"></a>            <span class="n">mode</span><span class="o">=</span><span class="s1">'lines'</span><span class="p">,</span>
</span><span id="__span-2-28"><a href="#__codelineno-2-28" id="__codelineno-2-28" name="__codelineno-2-28"></a>            <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">px</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">qualitative</span><span class="o">.</span><span class="n">D3</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
</span><span id="__span-2-29"><a href="#__codelineno-2-29" id="__codelineno-2-29" name="__codelineno-2-29"></a>        <span class="p">),</span>
</span><span id="__span-2-30"><a href="#__codelineno-2-30" id="__codelineno-2-30" name="__codelineno-2-30"></a>        <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="__span-2-31"><a href="#__codelineno-2-31" id="__codelineno-2-31" name="__codelineno-2-31"></a>        <span class="n">col</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="__span-2-32"><a href="#__codelineno-2-32" id="__codelineno-2-32" name="__codelineno-2-32"></a>    <span class="p">)</span>
</span><span id="__span-2-33"><a href="#__codelineno-2-33" id="__codelineno-2-33" name="__codelineno-2-33"></a>
</span><span id="__span-2-34"><a href="#__codelineno-2-34" id="__codelineno-2-34" name="__codelineno-2-34"></a>    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">):</span>
</span><span id="__span-2-35"><a href="#__codelineno-2-35" id="__codelineno-2-35" name="__codelineno-2-35"></a>        <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
</span><span id="__span-2-36"><a href="#__codelineno-2-36" id="__codelineno-2-36" name="__codelineno-2-36"></a>            <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
</span><span id="__span-2-37"><a href="#__codelineno-2-37" id="__codelineno-2-37" name="__codelineno-2-37"></a>                <span class="n">x</span><span class="o">=</span><span class="n">test_x</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span>
</span><span id="__span-2-38"><a href="#__codelineno-2-38" id="__codelineno-2-38" name="__codelineno-2-38"></a>                <span class="n">y</span><span class="o">=</span><span class="n">gen_model</span><span class="p">(</span><span class="n">posterior</span><span class="o">.</span><span class="n">sample</span><span class="p">(),</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">test_x</span><span class="p">),</span>
</span><span id="__span-2-39"><a href="#__codelineno-2-39" id="__codelineno-2-39" name="__codelineno-2-39"></a>                <span class="n">mode</span><span class="o">=</span><span class="s1">'lines'</span><span class="p">,</span>
</span><span id="__span-2-40"><a href="#__codelineno-2-40" id="__codelineno-2-40" name="__codelineno-2-40"></a>                <span class="n">opacity</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
</span><span id="__span-2-41"><a href="#__codelineno-2-41" id="__codelineno-2-41" name="__codelineno-2-41"></a>                <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">px</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">qualitative</span><span class="o">.</span><span class="n">D3</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
</span><span id="__span-2-42"><a href="#__codelineno-2-42" id="__codelineno-2-42" name="__codelineno-2-42"></a>            <span class="p">),</span>
</span><span id="__span-2-43"><a href="#__codelineno-2-43" id="__codelineno-2-43" name="__codelineno-2-43"></a>            <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="__span-2-44"><a href="#__codelineno-2-44" id="__codelineno-2-44" name="__codelineno-2-44"></a>            <span class="n">col</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="__span-2-45"><a href="#__codelineno-2-45" id="__codelineno-2-45" name="__codelineno-2-45"></a>        <span class="p">)</span>
</span><span id="__span-2-46"><a href="#__codelineno-2-46" id="__codelineno-2-46" name="__codelineno-2-46"></a>
</span><span id="__span-2-47"><a href="#__codelineno-2-47" id="__codelineno-2-47" name="__codelineno-2-47"></a>    <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">margin</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">l</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">20</span><span class="p">))</span>
</span><span id="__span-2-48"><a href="#__codelineno-2-48" id="__codelineno-2-48" name="__codelineno-2-48"></a>    <span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></code></pre></div>
</div>
</div>
</input></input></div>
<p>What we are left with is a posterior distribution <span class="arithmatex">\(p(\mb{w} | \mb{y}, X)\)</span>. We can convert this into a straight-up Bayesian prediction for a new point <span class="arithmatex">\(\mb{x}_*\)</span>, given the data <span class="arithmatex">\(X\)</span>, by writing</p>
<div class="arithmatex">\[
    p(f_* | \mb{x}_*, \mb{y}, X) = \int\!\ud\mb{w}\, p(f_* | \mb{x}_*, \mb{w}) p(\mb{w} | \mb{y}, X)\,,
\]</div>
<p>where we've taken the same generative model (that depends on the parameters <span class="arithmatex">\(\mb{w}\)</span>) and just integrated it against the generative model. This just works out to be</p>
<div class="arithmatex">\[
    p(f_* | \mb{x}_*, \mb{y}, X) = \mathcal{N}(\sigma_n^{-2} \mb{x}_* A^{-1} X^\top \mb{y}, \mb{x}_*^\top A^{-1} \mb{x}_*)
\]</div>
<h2 id="projections-of-inputs-into-feature-space">Projections of Inputs into Feature Space</h2>
<p>Now, linear regression is great but we would like to go beyond to nonlinear regression, increasing the expressivity of our models. An easy way to do this is, instead of restricting ourselves to models of the form <span class="arithmatex">\(f(x) = w_0 + w_1 x\)</span>, we can just add another basis vector<sup id="fnref:1"><a class="footnote-ref" href="#fn:1">1</a></sup> and instead consider models of the form <span class="arithmatex">\(f(x) = w_0 + w_1 x + w_2 x^2 + \cdots\)</span>.</p>
<p>Defining the <span class="arithmatex">\(d\)</span>-dimensional "feature" vector <span class="arithmatex">\(\Phi^a(x) = (1, x, x^2, \cdots)\)</span> and extending the vector of parameters <span class="arithmatex">\(\mb{w}\)</span> to have length <span class="arithmatex">\(d\)</span> so that <span class="arithmatex">\(f(x)\)</span> can express an arbitrary degree-<span class="arithmatex">\(d\)</span> polynomial, we can write an arbitrary model in this class as </p>
<div class="arithmatex">\[ f(x) = \phi^a(x) w_a\,, \]</div>
<p>and we'll denote the aggregation of the feature vectors of all samples <span class="arithmatex">\(\phi^a(x_i)\)</span> as <span class="arithmatex">\(\Phi = \Phi(X) \equiv \Phi^a_i\)</span>. Generally, to conform with <code>torch</code>'s conventions we will think of <span class="arithmatex">\(\Phi\)</span> as a <span class="arithmatex">\(n \times d\)</span> matrix. We'll write <span class="arithmatex">\(\Phi(X) \mb{w} = \Phi_i^a w_a\)</span> so that <span class="arithmatex">\(w_a\)</span> appears as a column vector, if we are doing straightup matrix multiplication.</p>
<p>Note that since we will consider <span class="arithmatex">\(\phi(\mb{x})\)</span> to be a <strong>row vector</strong>, then <span class="arithmatex">\(\Phi(X)\)</span> is a <span class="arithmatex">\(n \times d\)</span> matrix, while <span class="arithmatex">\(\mb{w}\)</span> is a <span class="arithmatex">\(d\)</span>-dimensional <strong>column vector</strong>. This means that <span class="arithmatex">\(\mb{y} = \Phi(X) \mb{w}\)</span> is a <span class="arithmatex">\(n\)</span>-dimensional vector$, as we should expect. </p>
<p>Looking back at what we've done, what exactly changes? Well, clearly we can simply take <span class="arithmatex">\(X \to \Phi(X)\)</span>, and so the likelihood is</p>
<div class="arithmatex">\[ 
    p(\mb{y} | X, \mb{w}) \propto \exp\left(-\frac{1}{2 \sigma_n^2} \left|\mb{y} - \Phi(X) \mb{w}\right|^2  - \frac{1}{2} \mb{w}^\top \Sigma_p^{-1} \mb{w}\right)\,,
\]</div>
<p>or</p>
<div class="arithmatex">\[
    p(\mb{y} | X, \mb{w}) \propto \exp\left(-\frac{1}{2 \sigma_n^2} \left|y_i - \Phi_i^a w_a\right|^2  - \frac{1}{2} w_a \Sigma_{p,ab}^{-1} w_b \right)
\]</div>
<p>with associated posterior density</p>
<div class="arithmatex">\[
    p(\mb{w} | \mb{y}, X) = \mathcal{N}(\bar{\mb{w}}, A^{-1})\,.
\]</div>
<p>Again, we define the mean of this posterior as</p>
<div class="arithmatex">\[
    \overline{\mb{w}} = \frac{1}{\sigma_n^2} \left(\Sigma_p^{-1} + \frac{1}{\sigma_n^2} \Phi^\top(X) \Phi(X)\right)^{-1} \Phi^\top(X) \mb{y}
\]</div>
<p>and its covariance matrix</p>
<div class="arithmatex">\[
A = \frac{1}{\sigma_n^2} \Phi^\top(X) \Phi(X) + \Sigma_p^{-1}\,,
\]</div>
<p>both having more-or-less the same form as the linear regression example. </p>
<p>Furthermore, if we are only interested in making predictions then the predictive distribution is simply</p>
<div class="arithmatex">\[
    p(f_* | \mb{x}_*, \mb{y}, X) = \mathcal{N}(\sigma_n^{-2} \bm{\phi}_* A^{-1} \Phi(x)^\top \mb{y}, \bm{\phi}_*^\top A^{-1} \bm{\phi}_*)\,,
\]</div>
<p>where <span class="arithmatex">\(\bm{\phi}_* \equiv \phi(\mb{x}_*)\)</span> is a <span class="arithmatex">\(d\)</span>-dimensional vector.</p>
<p>Now, let's consider what this means. <span class="arithmatex">\(\Phi(X)\)</span>, as written, is a <span class="arithmatex">\(n \times d\)</span> matrix, where <span class="arithmatex">\(d\)</span> is the number of basis functions, parameters or the dimensionality of feature space, while <span class="arithmatex">\(n\)</span> is the number of points in <span class="arithmatex">\(X\)</span>. We must then invert <span class="arithmatex">\(A\)</span>, an <span class="arithmatex">\(d \times d\)</span> matrix, everytime we want to make predictions, which can be pretty bad if <span class="arithmatex">\(d \gg n\)</span>, that is, the number of parameters or the dimension of feature space is much larger than the number of points.</p>
<p>But no one says we have to invert this matrix. For instance, if we are interested in predictions, what we really need to compute <span class="arithmatex">\(\bm{\phi}_*^\top A^{-1} \bm{\phi}_*\)</span>, which is a single number. There's a bunch of ways to compute a single number, and if we are clever about it we can avoid inverting massive matrices. To be clever, we have to reorganize </p>
<div class="arithmatex">\[ 
    \bm{\phi}_*^\top A^{-1} \bm{\phi}_* = \bm{\phi}_*^\top \left(\sigma_n^{-2} \Phi^\top \Phi + \Sigma_p^{-1}\right)^{-1} \bm{\phi}_*\,.
\]</div>
<p>The basic idea is to group terms so that we only have to invert an <span class="arithmatex">\(n \times n\)</span> matrix. If we squint, we can see the way forward. <span class="arithmatex">\(\Sigma_p\)</span> is a <span class="arithmatex">\(d \times d\)</span> matrix and <span class="arithmatex">\(\Phi\)</span> is a <span class="arithmatex">\(n \times d\)</span> matrix, so <span class="arithmatex">\(K \equiv \Phi \Sigma_p \Phi^\top\)</span> is a <span class="arithmatex">\(n \times n\)</span> matrix.</p>
<p>We are saved by a matrix identity. Note that</p>
<div class="arithmatex">\[
\left(Z + U W V^\top\right)^{-1} = Z^{-1} - Z^{-1} U \left(W^{-1} + V^\top Z^{-1} U\right)^{-1} V^\top Z^{-1}
\]</div>
<p>and so if we identify <span class="arithmatex">\(Z = \Sigma_p^{-1}\)</span>, <span class="arithmatex">\(U = V = \sigma_n^{-1} \Phi^\top\)</span>, and <span class="arithmatex">\(W = \mathbb{I}\)</span>, then</p>
<div class="arithmatex">\[\bm{\phi}_*^\top \left(\sigma_n^{-2} \Phi^\top \Phi + \Sigma_p^{-1}\right)^{-1} \bm{\phi}_* = \bm{\phi}_*^\top \Sigma_p \bm{\phi}_* - \bm{\phi}_*^\top \Sigma_p \Phi(K + \sigma_n^2 \mathbb{I})^{-1} \Phi^\top \Sigma_p \bm{\phi}_* \]</div>
<p>and we are only inverting the <span class="arithmatex">\(n \times n\)</span> matrix <span class="arithmatex">\(K + \sigma_n^2 \mathbb{I}\)</span>. We see that</p>
<div class="arithmatex">\[
    \sigma_n^{-2} \Phi^\top (K + \sigma_n^2 \mathbb{I}) = \sigma_n^2 \Phi^\top (\Phi \Sigma_p \Phi^\top + \sigma_n^2 \mathbb{I}) = A \Sigma_p \Phi^\top
\]</div>
<p>This allows us to rewrite the predictive density as</p>
<div class="arithmatex">\[
p(f_* | \mb{x}_*, X, \mb{y}) = \mathcal{N} \!\left(\bm{\phi}_* \Sigma_p \Phi^\top \right)
\]</div>
<div class="footnote">
<hr/>
<ol>
<li id="fn:1">
<p>Literally, another basis vector in the space of functions. <a class="footnote-backref" href="#fnref:1" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
</ol>
</div>
</article>
</div>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../..", "features": ["content.code.copy", "content.code.annotate", "navigation.tabs"], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
<script src="../../assets/javascripts/bundle.83f73b43.min.js"></script>
<script src="../../javascripts/mathjax.js"></script>
<script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
<span hidden="True" id="default-template-settings">{"font.color": "#2a3f5f", "paper_bgcolor": "rgba(0,0,0,0)", "plot_bgcolor": "#E5ECF6", "polar.bgcolor": "#E5ECF6", "polar.angularaxis.gridcolor": "white", "polar.angularaxis.linecolor": "white", "polar.radialaxis.gridcolor": "white", "polar.radialaxis.linecolor": "white", "ternary.bgcolor": "#E5ECF6", "ternary.aaxis.gridcolor": "white", "ternary.aaxis.linecolor": "white", "ternary.baxis.gridcolor": "white", "ternary.baxis.linecolor": "white", "ternary.caxis.gridcolor": "white", "ternary.caxis.linecolor": "white", "xaxis.gridcolor": "white", "xaxis.linecolor": "white", "xaxis.zerolinecolor": "white", "yaxis.gridcolor": "white", "yaxis.linecolor": "white", "yaxis.zerolinecolor": "white", "scene.xaxis.backgroundcolor": "#E5ECF6", "scene.xaxis.gridcolor": "white", "scene.xaxis.linecolor": "white", "scene.xaxis.zerolinecolor": "white", "scene.yaxis.backgroundcolor": "#E5ECF6", "scene.yaxis.gridcolor": "white", "scene.yaxis.linecolor": "white", "scene.yaxis.zerolinecolor": "white", "scene.zaxis.backgroundcolor": "#E5ECF6", "scene.zaxis.gridcolor": "white", "scene.zaxis.linecolor": "white", "scene.zaxis.zerolinecolor": "white", "shapedefaults.line.color": "#2a3f5f", "annotationdefaults.arrowcolor": "#2a3f5f", "geo.bgcolor": "white", "geo.landcolor": "#E5ECF6", "geo.subunitcolor": "white", "geo.lakecolor": "white", "mapbox.style": "light"}</span><span hidden="True" id="slate-template-settings">{"font.color": "#f2f5fa", "paper_bgcolor": "rgba(0,0,0,0)", "plot_bgcolor": "rgb(17,17,17)", "polar.bgcolor": "rgb(17,17,17)", "polar.angularaxis.gridcolor": "#506784", "polar.angularaxis.linecolor": "#506784", "polar.radialaxis.gridcolor": "#506784", "polar.radialaxis.linecolor": "#506784", "ternary.bgcolor": "rgb(17,17,17)", "ternary.aaxis.gridcolor": "#506784", "ternary.aaxis.linecolor": "#506784", "ternary.baxis.gridcolor": "#506784", "ternary.baxis.linecolor": "#506784", "ternary.caxis.gridcolor": "#506784", "ternary.caxis.linecolor": "#506784", "xaxis.gridcolor": "#283442", "xaxis.linecolor": "#506784", "xaxis.zerolinecolor": "#283442", "yaxis.gridcolor": "#283442", "yaxis.linecolor": "#506784", "yaxis.zerolinecolor": "#283442", "scene.xaxis.backgroundcolor": "rgb(17,17,17)", "scene.xaxis.gridcolor": "#506784", "scene.xaxis.linecolor": "#506784", "scene.xaxis.zerolinecolor": "#C8D4E3", "scene.yaxis.backgroundcolor": "rgb(17,17,17)", "scene.yaxis.gridcolor": "#506784", "scene.yaxis.linecolor": "#506784", "scene.yaxis.zerolinecolor": "#C8D4E3", "scene.zaxis.backgroundcolor": "rgb(17,17,17)", "scene.zaxis.gridcolor": "#506784", "scene.zaxis.linecolor": "#506784", "scene.zaxis.zerolinecolor": "#C8D4E3", "shapedefaults.line.color": "#f2f5fa", "annotationdefaults.arrowcolor": "#f2f5fa", "geo.bgcolor": "rgb(17,17,17)", "geo.landcolor": "rgb(17,17,17)", "geo.subunitcolor": "#506784", "geo.lakecolor": "rgb(17,17,17)", "mapbox.style": "dark"}</span><script src="../../assets/javascripts/mkdocs-plotly-plugin.js"></script></body>
</html>